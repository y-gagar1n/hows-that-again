{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/architecture","result":{"data":{"markdownRemark":{"html":"<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D0%BC%D0%B0%D1%81%D1%82%D0%B0%D0%B1%D0%B8%D1%80%D1%83%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D0%B8-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D0%BE%D1%81%D1%82%D0%B8-%D1%81%D1%82%D0%B0%D0%B1%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8\">Паттерны мастабируемости, доступности, стабильности</a></p>\n<ul>\n<li>\n<p><a href=\"#%D1%82%D1%80%D0%B5%D0%B9%D0%B4%D0%BE%D1%84%D1%84%D1%8B\">Трейдоффы</a></p>\n<ul>\n<li><a href=\"#%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C-vs-%D0%BC%D0%B0%D1%81%D1%88%D1%82%D0%B0%D0%B1%D0%B8%D1%80%D1%83%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D1%8C\">Производительность vs Масштабируемость</a></li>\n<li><a href=\"#%D0%B7%D0%B0%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0-vs-%D0%BF%D1%80%D0%BE%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%B0%D1%8F-%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%BD%D0%BE%D1%81%D1%82%D1%8C\">Задержка vs Пропускная способность</a></li>\n<li><a href=\"#%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D0%BE%D1%81%D1%82%D1%8C-vs-%D0%BA%D0%BE%D0%BD%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8C\">Доступность vs Консистентность</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D0%BE%D1%81%D1%82%D0%B8\">Паттерны доступности</a></p>\n<ul>\n<li>\n<p><a href=\"#failover--failback\">Failover &#x26;&#x26; Failback</a></p>\n<ul>\n<li><a href=\"#%D0%B0%D0%BA%D1%82%D0%B8%D0%B2-%D0%BF%D0%B0%D1%81%D1%81%D0%B8%D0%B2\">Актив-пассив</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%D1%80%D0%B5%D0%BF%D0%BB%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F\">Репликация</a></p>\n<ul>\n<li><a href=\"#tree-replication\">Tree Replication</a></li>\n<li><a href=\"#buddy-replication\">Buddy Replication</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D0%BC%D0%B0%D1%81%D1%88%D1%82%D0%B0%D0%B1%D0%B8%D1%80%D1%83%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D0%B8\">Паттерны масштабируемости</a></p>\n<ul>\n<li>\n<p><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F\">Паттерны состояния</a></p>\n<ul>\n<li><a href=\"#%D0%BF%D0%B0%D1%80%D1%82%D0%B8%D1%88%D0%BD%D0%B8%D0%BD%D0%B3\">Партишнинг</a></li>\n<li><a href=\"#%D1%80%D0%B5%D0%BF%D0%BB%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F-1\">Репликация</a></li>\n<li><a href=\"#http-%D0%BA%D1%8D%D1%88%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5\">HTTP-кэширование</a></li>\n<li>\n<p><a href=\"#%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%B5-%D0%BA%D1%8D%D1%88%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5\">Распределенное кэширование</a></p>\n<ul>\n<li><a href=\"#%D0%BF%D0%BE%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B8-%D0%B8%D1%81%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F\">Политики исключения</a></li>\n</ul>\n</li>\n<li><a href=\"#concurrency\">Concurrency</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D0%BF%D0%BE%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F\">Паттерны поведения</a></p>\n<ul>\n<li>\n<p><a href=\"#event-driven-architecture\">Event-Driven Architecture</a></p>\n<ul>\n<li><a href=\"#event-sourcing\">Event Sourcing</a></li>\n<li><a href=\"#cqrs\">CQRS</a></li>\n<li><a href=\"#event-stream-processing\">Event Stream Processing</a></li>\n<li><a href=\"#messaging\">Messaging</a></li>\n<li><a href=\"#esb\">ESB</a></li>\n<li><a href=\"#actors\">Actors</a></li>\n<li><a href=\"#compute-grids\">Compute Grids</a></li>\n<li><a href=\"#load-balacing\">Load balacing</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D1%81%D1%82%D0%B0%D0%B1%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8\">Паттерны стабильности</a></li>\n</ul>\n</div>\n<h1 id=\"паттерны-мастабируемости-доступности-стабильности\" style=\"position:relative;\"><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D0%BC%D0%B0%D1%81%D1%82%D0%B0%D0%B1%D0%B8%D1%80%D1%83%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D0%B8-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D0%BE%D1%81%D1%82%D0%B8-%D1%81%D1%82%D0%B0%D0%B1%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8\" aria-label=\"паттерны мастабируемости доступности стабильности permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Паттерны мастабируемости, доступности, стабильности</h1>\n<p><a href=\"https://www.slideshare.net/jboner/scalability-availability-stability-patterns/\">https://www.slideshare.net/jboner/scalability-availability-stability-patterns/</a></p>\n<h2 id=\"трейдоффы\" style=\"position:relative;\"><a href=\"#%D1%82%D1%80%D0%B5%D0%B9%D0%B4%D0%BE%D1%84%D1%84%D1%8B\" aria-label=\"трейдоффы permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Трейдоффы</h2>\n<h3 id=\"производительность-vs-масштабируемость\" style=\"position:relative;\"><a href=\"#%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C-vs-%D0%BC%D0%B0%D1%81%D1%88%D1%82%D0%B0%D0%B1%D0%B8%D1%80%D1%83%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D1%8C\" aria-label=\"производительность vs масштабируемость permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Производительность vs Масштабируемость</h3>\n<p>Проблемы с <strong>производительностью</strong> - это когда приложение работает медленно для одного юзера.</p>\n<p>Проблемы с <strong>масштабируемостью</strong> - это когда быстро работает для одного юзера, но медленно под большой нагрузкой</p>\n<h3 id=\"задержка-vs-пропускная-способность\" style=\"position:relative;\"><a href=\"#%D0%B7%D0%B0%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0-vs-%D0%BF%D1%80%D0%BE%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%B0%D1%8F-%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%BD%D0%BE%D1%81%D1%82%D1%8C\" aria-label=\"задержка vs пропускная способность permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Задержка vs Пропускная способность</h3>\n<p>В идеале нужно стремиться к <strong>максимальной</strong> пропускной способности с <strong>приемлемыми</strong> задержками.</p>\n<h3 id=\"доступность-vs-консистентность\" style=\"position:relative;\"><a href=\"#%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D0%BE%D1%81%D1%82%D1%8C-vs-%D0%BA%D0%BE%D0%BD%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8C\" aria-label=\"доступность vs консистентность permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Доступность vs Консистентность</h3>\n<p>См. CAP-теорему.</p>\n<p>В современных NoSQL-системах обычно находятся посередине между CP и AP, поэтому их относят к BASE-системам:</p>\n<ul>\n<li>Basically Available</li>\n<li>Soft state</li>\n<li>Eventually consistent</li>\n</ul>\n<p>К BASE-системам относятся:</p>\n<ul>\n<li>Cassandra</li>\n<li>Riak</li>\n<li>Voldemort</li>\n<li>Dynomite</li>\n<li>SimpleDB</li>\n<li>и другие</li>\n</ul>\n<p>На другом конце спектрума находятся ACID-системы:</p>\n<ul>\n<li>Atomicity</li>\n<li>Consistency</li>\n<li>Isolation</li>\n<li>Durability</li>\n</ul>\n<p>К ACID-системам относятся:</p>\n<ul>\n<li>Реляционные БД (MySQL, Oracle, Postgres)</li>\n<li>Объектные БД (Gemstone, db4o)</li>\n<li>Кластеризующие продукты (Coherence, Terracotta, Hazelcast, GigaSpaces, GemStone)</li>\n<li>Большинство кэшей (ehcache)</li>\n</ul>\n<h1 id=\"паттерны-доступности\" style=\"position:relative;\"><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D0%BE%D1%81%D1%82%D0%B8\" aria-label=\"паттерны доступности permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Паттерны доступности</h1>\n<h2 id=\"failover--failback\" style=\"position:relative;\"><a href=\"#failover--failback\" aria-label=\"failover  failback permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Failover &#x26;&#x26; Failback</h2>\n<h3 id=\"актив-пассив\" style=\"position:relative;\"><a href=\"#%D0%B0%D0%BA%D1%82%D0%B8%D0%B2-%D0%BF%D0%B0%D1%81%D1%81%D0%B8%D0%B2\" aria-label=\"актив пассив permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Актив-пассив</h3>\n<p>Когда узел или вся система перестает отвечать, нужно выдавать какой-то статичный ответ на запросы к нему, либо же поставить на его место другой, рабочий сервер. Для этого активный сервер шлет пассивному серверу heartbeat-сообщения. Если сообщения перестали приходить, пассивный сервер берет себе IP-адрес активного и продолжает работу. </p>\n<p>Обычно процесс переключения не так прост:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 467px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/hows-that-again/static/b36643185b228467f8e48240578ce502/85ff8/failback.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 111.04294478527608%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAADBElEQVQ4y22V6VLiUBCF8/6v4z+r1CkYS2UVCYssYSAoO7iAG2hPf42didR01QWSe3s75/QlELXVaiXz+VyWy6V8fX2J23a71b2lPDw8yMfHhxwa7/B5fHxM9gOCjUYjc5pMJjKbzeT19VXe39/tcOW6LOVySeaLhby9vcnT05Ptk4z9fD6v+2VZ6O/Pz08JhsOhhGFVzn6dyW2rJVHUk5ubGxmPx5agWq1KoViQ2Xxmz+fn59Ltdi14Tf0ymYwU8jnpdLpWZTCZTiwAmZvNpgVy6/V6cnp6KplsVtrt9o92gabRaFjArO7f3rb2LfPR7/fl6OhIWq1WchijbTpgURFroa2T1HG7u7uzfc4mAakud3Ul0+k0CZgmx+3l5UVb61jLHgDcWO4X8EBW1lIZ3e12SQDApyqcIS29h1EAFbIcqmC9XivYY6lUKjLRA8/Pz0lmHNoKw59eJNPZnhRwpUXUAa5xPJDBIJZuFFkHATKJtIXf2YyBPPrORDVR1FWwb7XNljr1dQ2MOIKSLJ+70r22+jWlUCgIxQVEpTqCoifadLu/vzeNzr6rO7RqNZRarWZJwjD8RwoiBQMqgGmmxg3sIm2HZCSlcmBBGU5QOlngbHIQ53qtblVBRJqEOI4tKcmdSNSR1qWx7AHTrYIFjsDBtxtk0D4J2XPy0jJLAm42G9lfFEuJ1XE8HllVsOkJe9p6oZBT3EKrMF1ZEpAPMLm4uEj0ONe57alUfJ79DKwfHx9LsVg0GaWD/QgIXt1ux9rAEWKcJITtGKM7GK036nbT/G+qgvQDs4kMWFQKgy50x2uzWVuwk5MTm5DDoIEfdmZ9RjFEDY5pJr0jxA0cJPHL1VjmgdbYJICzzSa/bU51z0lLGzcOigAWZz3YX0+xMhurJKYW3MWOziCiqYlwZPn1ZZeJtg4sPtv4BFRVq1UlVNxClUOj2dgH3G1tQpBJLncpbb2RSUAgJmSlQ9BRkvh7uFSF8M4CErlUKtncMl7psSPztb671v8VRu3QhqbXvbScoL9e536mYW2CzgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Failback\"\n        title=\"Failback\"\n        src=\"/hows-that-again/static/b36643185b228467f8e48240578ce502/85ff8/failback.png\"\n        srcset=\"/hows-that-again/static/b36643185b228467f8e48240578ce502/222b7/failback.png 163w,\n/hows-that-again/static/b36643185b228467f8e48240578ce502/ff46a/failback.png 325w,\n/hows-that-again/static/b36643185b228467f8e48240578ce502/85ff8/failback.png 467w\"\n        sizes=\"(max-width: 467px) 100vw, 467px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"репликация\" style=\"position:relative;\"><a href=\"#%D1%80%D0%B5%D0%BF%D0%BB%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F\" aria-label=\"репликация permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Репликация</h2>\n<p>4 паттерна репликации:</p>\n<ul>\n<li>мастер-слейв</li>\n<li>мастер-мастер</li>\n<li>Tree Replication</li>\n<li>Buddy Replication</li>\n</ul>\n<h3 id=\"tree-replication\" style=\"position:relative;\"><a href=\"#tree-replication\" aria-label=\"tree replication permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tree Replication</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 519px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/hows-that-again/static/fa4415820a5484f762d924e9529d6846/b23ad/tree-replication.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.03067484662577%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABgElEQVQ4y3WTSa7CQAxEc/9DsOcC7NlkBxJSIhZMgZAIMU9hBn89fxUiDJZMWm53uVw2we12s/P5bJfL5adfr1f39/jpdLL1em2r1cq/YAWAcbjf7x/+eDy8WLPZtDAMbTKZGEa+7gaDgXU6Hev1el4goBKPfxkP6/W6VavVJyCxb0aBQC3v93vb7XZ2PB69HWI4VTebjc3nc895vXvPQ5aAalzkeW5JkthsNnOAVz8cDl4MRyti6EZxQAROp4FExwgAKE2lFTmAST/uAIE1Z4gMh8N/hiQrMcsyFxkWMpIajYbrCIBsOp36ICCgonhpKP1+3+I4tsViURpKrVazSqXissg4t1otG41Gz+4cEOoYrGAIC+0Yjn4MQ14Uhcdw7kXmCcgPLCQ8wJy1yNwhBwPQQ+0gebISoKqQxK5tt9tSIhNFM3WDwZa2YfyVIdbtdn0AaZqWlrXdblsURT4AGVPlH8QQPwDRgu9yubTxeOxtvy4t7IhrsXFyiPEGeYTxB6dU6tkU5sbHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Tree Replication\"\n        title=\"Tree Replication\"\n        src=\"/hows-that-again/static/fa4415820a5484f762d924e9529d6846/b23ad/tree-replication.png\"\n        srcset=\"/hows-that-again/static/fa4415820a5484f762d924e9529d6846/222b7/tree-replication.png 163w,\n/hows-that-again/static/fa4415820a5484f762d924e9529d6846/ff46a/tree-replication.png 325w,\n/hows-that-again/static/fa4415820a5484f762d924e9529d6846/b23ad/tree-replication.png 519w\"\n        sizes=\"(max-width: 519px) 100vw, 519px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"buddy-replication\" style=\"position:relative;\"><a href=\"#buddy-replication\" aria-label=\"buddy replication permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Buddy Replication</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 432px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/hows-that-again/static/1846cb5571704aafec8ada45e4c8f5ac/0e0c3/buddy-replication1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.91411042944786%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8UlEQVQ4y31T2XLCMAzM/38WwwtMS4FCSEIJQy4SQg7ucKpaDQaTDvWMG2pL69WuZNxuN7per2/3arWm7XZLu92Of6/ocrnQuxycG/ijb3WJdTweKUli8r0Zue6EiqKgzWYjdzqIvg26L/xTX6fTiZbLlD4/P6jz1REwBagvPdfQD8AoiiKaz+dS5uFwIMsa0dAckuM4NJ1Oab1e06osKQpDipOEzufzC6iho4OR7/sUBD4Hx1Ry4mw2I8/z5IsNhiGD+b5HfhBIjs5UGOKVLFtKcFUdRHyY8G6B+WKxkC9yoO1+v3+WjPIQYI5GwqLIcwlW4teFx064XMT2+30BQ/4DEAdRFFKr1aKf8ZhKZqgA60DqkSzLaMQE2u02M8zZvOUTEOUNBt9sgEW2bdNkMqHzXRsFUgeFQQBEvG1brwyxCjYAWgAMLusgdWAlk+u6UnrGEr20TRzH3BaWBKB1qqr602c6uDqDLGizMcvkTl0x9+EyykYAXsar+KJt6m6rEcyZFYiUd4eR+xg9faVpKgJ3u10BRhIeRL9hjtGDOOv1elJqukhf8o16SQAL2fFGoyGJAFAzrDd1s9kUI5S7b2cZmsC54dAUg8IwYI0c7oKBTIy6N01TNMcD/wJCD4wfnAYAZle/h4YBjxyAwRRa64C/IdDNsY6EmOEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Buddy Replication before\"\n        title=\"Buddy Replication before\"\n        src=\"/hows-that-again/static/1846cb5571704aafec8ada45e4c8f5ac/0e0c3/buddy-replication1.png\"\n        srcset=\"/hows-that-again/static/1846cb5571704aafec8ada45e4c8f5ac/222b7/buddy-replication1.png 163w,\n/hows-that-again/static/1846cb5571704aafec8ada45e4c8f5ac/ff46a/buddy-replication1.png 325w,\n/hows-that-again/static/1846cb5571704aafec8ada45e4c8f5ac/0e0c3/buddy-replication1.png 432w\"\n        sizes=\"(max-width: 432px) 100vw, 432px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 444px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/hows-that-again/static/33ad36f1fbc76e18ac1d958269feccb4/9b7bd/buddy-replication2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.4601226993865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACMElEQVQ4y31Ty47aQBDkK/MP+Ycc8viFKPecV1pFWWmlHEnilXJKDgsB2bDYxgbbGGMw+DW40t0wC4YkLbU8M+6p7q7q6TRNg/1+f+V8rpTCZrNBnufYbrfIsgzNX2J1PHtHLy6drSgK+L4H07Lg2BOEwVySnBdxea/DF08Her0XwKqqMB6P8M0wMO33kQQB1DGZtuZi32kdHBCftwW1OhpZGD+N4TkOgY+ldZuqtajqOVV8CSwV1tsEqipR0VqRl/EcZXII9jwPw+EQnu9juVwKp4tFhDRNsdvthAJuXYMKYJGlmD/cYm3+Qnx/g/DjO5THjGVZPl/QliQJoijEarWSdRzH7QqLukE0ecTqw0v4r18g/PpJqiVJqaLsqi0Wiys3jO9EyQiLKJJKT4AUEIQL5DdvUN6+Rfz+FYo0kQDHtqVli7hk/tj4Oxj8Jm4nItSc+FXHLgSQN08/vqBv3KNvmhj+fMDWHWCX74QnTsiuq2Aa+qR6r9eDSfE+8dvisNkrVHmGvFLICUAzlpEA/zIe9jAMMZvNEJNYnOR6bI7G85fnBZGetoZXJqKuxVlxFsWxHUyIlnS9PrV8foED42VM2QOpgMdDG4PzGYsQEHchfc8LunopGtB1bdzdfaavI/ywCEVR0r9EAA16Od1uV2K1UK2xOT+IKKtNLVjWCNPplMZjSooOSIBH2bPzqDikrOu6wuV/AdfEhYyJZYqSXIVStajMLTMgJzjEWK1XwvYHJMF8iPz7av8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Buddy Replication after\"\n        title=\"Buddy Replication after\"\n        src=\"/hows-that-again/static/33ad36f1fbc76e18ac1d958269feccb4/9b7bd/buddy-replication2.png\"\n        srcset=\"/hows-that-again/static/33ad36f1fbc76e18ac1d958269feccb4/222b7/buddy-replication2.png 163w,\n/hows-that-again/static/33ad36f1fbc76e18ac1d958269feccb4/ff46a/buddy-replication2.png 325w,\n/hows-that-again/static/33ad36f1fbc76e18ac1d958269feccb4/9b7bd/buddy-replication2.png 444w\"\n        sizes=\"(max-width: 444px) 100vw, 444px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h1 id=\"паттерны-масштабируемости\" style=\"position:relative;\"><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D0%BC%D0%B0%D1%81%D1%88%D1%82%D0%B0%D0%B1%D0%B8%D1%80%D1%83%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D0%B8\" aria-label=\"паттерны масштабируемости permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Паттерны масштабируемости</h1>\n<h2 id=\"паттерны-состояния\" style=\"position:relative;\"><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F\" aria-label=\"паттерны состояния permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Паттерны состояния</h2>\n<h3 id=\"партишнинг\" style=\"position:relative;\"><a href=\"#%D0%BF%D0%B0%D1%80%D1%82%D0%B8%D1%88%D0%BD%D0%B8%D0%BD%D0%B3\" aria-label=\"партишнинг permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Партишнинг</h3>\n<h3 id=\"репликация-1\" style=\"position:relative;\"><a href=\"#%D1%80%D0%B5%D0%BF%D0%BB%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F-1\" aria-label=\"репликация 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Репликация</h3>\n<h3 id=\"http-кэширование\" style=\"position:relative;\"><a href=\"#http-%D0%BA%D1%8D%D1%88%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5\" aria-label=\"http кэширование permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTTP-кэширование</h3>\n<p>Через заголовок <code class=\"language-text\">Cache-Control</code>.</p>\n<ul>\n<li>Reverse-proxy</li>\n<li>CDN</li>\n</ul>\n<h3 id=\"распределенное-кэширование\" style=\"position:relative;\"><a href=\"#%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%B5-%D0%BA%D1%8D%D1%88%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5\" aria-label=\"распределенное кэширование permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Распределенное кэширование</h3>\n<ul>\n<li>Write-through: все записи в БД проходят через слой кэша</li>\n<li>Write-behind:  записи пишутся в кэш, а оттуда попадают в очередь, из которой отдельный сервис кладет в БД</li>\n</ul>\n<h4 id=\"политики-исключения\" style=\"position:relative;\"><a href=\"#%D0%BF%D0%BE%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B8-%D0%B8%D1%81%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F\" aria-label=\"политики исключения permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Политики исключения</h4>\n<ul>\n<li>TTL</li>\n<li>FIFO</li>\n<li>LIFO</li>\n<li>Explicit cache invalidation</li>\n</ul>\n<h3 id=\"concurrency\" style=\"position:relative;\"><a href=\"#concurrency\" aria-label=\"concurrency permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Concurrency</h3>\n<ul>\n<li>Shared-State Concurrency: </li>\n<li>Message-Passing Concurrency (Actors): ничего не шарится, процессы легковесные, коммуникация через асинхронные и неблокирующие сообщения, каждый актор имеет свою очередь сообщений</li>\n<li>Dataflow Concurrency: декларативное описание, треды блокируются, пока данные не станут доступны, ленивая обработка данных по требованию, нет разницы между параллельным и последовательным кодом. Ограничения: не может иметь сайд-эффектов.</li>\n<li>STM: память (куча и стэк) рассматриваются как транзакционное множество данных. При коллизии транзакции автоматически повторяются. При ошибке откатываются. Ограничения: все операции внутри транзакции должны быть <strong>идемпотентными</strong>.</li>\n</ul>\n<h2 id=\"паттерны-поведения\" style=\"position:relative;\"><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D0%BF%D0%BE%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F\" aria-label=\"паттерны поведения permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Паттерны поведения</h2>\n<ul>\n<li>Event-Driven Architecture</li>\n<li>Compute Grids</li>\n<li>Load-balancing</li>\n<li>Parallel Computing</li>\n</ul>\n<h3 id=\"event-driven-architecture\" style=\"position:relative;\"><a href=\"#event-driven-architecture\" aria-label=\"event driven architecture permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Event-Driven Architecture</h3>\n<ul>\n<li>Domain Events</li>\n<li>Event Sourcing</li>\n<li>CQRS</li>\n<li>Event Stream Processing</li>\n<li>Messaging</li>\n<li>ESB</li>\n<li>Actors</li>\n<li>Enterprise Integration Architecture</li>\n</ul>\n<h4 id=\"event-sourcing\" style=\"position:relative;\"><a href=\"#event-sourcing\" aria-label=\"event sourcing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Event Sourcing</h4>\n<ul>\n<li>Каждое изменение состояния представляется в виде <strong>Event/события</strong></li>\n<li>Все события шлются в <strong>EventProcessor</strong></li>\n<li>EventProcessor сохраняет все события в <strong>Event Log/журнал событий</strong></li>\n<li>Система может быть перезапущена и журнал событий будет проигран заново</li>\n<li>ORM не нужна, просто сохраняем события</li>\n<li>К EventProcessor может быть добавлено много <strong>EventListeners</strong></li>\n</ul>\n<h4 id=\"cqrs\" style=\"position:relative;\"><a href=\"#cqrs\" aria-label=\"cqrs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CQRS</h4>\n<p>Есть БД домена и БД запросов</p>\n<ul>\n<li>все изменения состояния представляются в виде <strong>Domain Events</strong></li>\n<li>корни аггрегации/БД домена <strong>принимают</strong> <em>команды</em> и <strong>паблишат</strong> <em>события</em></li>\n<li>БД запросов <strong>апдейтится</strong> в результате запаблишенных событий</li>\n<li>все запросы от слоя представления идут сразу в БД запросов, а БД домена не затрагивается</li>\n</ul>\n<h4 id=\"event-stream-processing\" style=\"position:relative;\"><a href=\"#event-stream-processing\" aria-label=\"event stream processing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Event Stream Processing</h4>\n<p>Обслуживает запросы типа:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">select * from Withdrawal(amount&gt;=200).win:length(5)</code></pre></div>\n<p>В этом запросе при каждом новом событии с <code class=\"language-text\">amount&gt;=200</code> оно будет выдано клиенту. Когда таких событий станет больше 5, то старые начнут выдаваться с пометкой OLD. Новые клиенты увидят только последние 5 таких событий.</p>\n<p>Продукты:</p>\n<ul>\n<li>Esper</li>\n<li>StreamBase</li>\n<li>RuleCast</li>\n</ul>\n<h4 id=\"messaging\" style=\"position:relative;\"><a href=\"#messaging\" aria-label=\"messaging permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Messaging</h4>\n<ul>\n<li>Pub-sub</li>\n<li>Point-to-Point</li>\n<li>Store-forward (отправитель шлет в медиатор, а он шлет получателю и еще куда-то, например в лог, или сохраняет в БД)</li>\n<li>Request-Reply (отправитель шлет запрос в очередь, получатель получает из очереди, формирует ответ на запрос, вовращает его в очередь, очередь возвращает его отправителю)</li>\n</ul>\n<p>Стандарты:</p>\n<ul>\n<li>AMQP</li>\n<li>JMS</li>\n</ul>\n<p>Продукты:</p>\n<ul>\n<li>RabbitMQ (AMQP)</li>\n<li>ActiveMQ (JMS)</li>\n<li>Tibco</li>\n<li>MQSeries</li>\n<li>и другие</li>\n</ul>\n<h4 id=\"esb\" style=\"position:relative;\"><a href=\"#esb\" aria-label=\"esb permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ESB</h4>\n<p>Все подключены к одной большой жирной шине, через которую проходят все события.</p>\n<h4 id=\"actors\" style=\"position:relative;\"><a href=\"#actors\" aria-label=\"actors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Actors</h4>\n<ul>\n<li>Fire-forget (async send)</li>\n<li>Fire-And-Receive-Eventually (async send + wait on Future for reply)</li>\n</ul>\n<h4 id=\"compute-grids\" style=\"position:relative;\"><a href=\"#compute-grids\" aria-label=\"compute grids permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Compute Grids</h4>\n<ul>\n<li>Divide and conquer (джобы разделяются на независимые таски, выполняются параллельно, результаты аггрегируются)</li>\n<li>MapReduce - Master/Worker</li>\n<li>Automatic provisioning</li>\n<li>Load balancing</li>\n<li>Fail-over</li>\n<li>Topology resolution</li>\n</ul>\n<p>Продукты:</p>\n<ul>\n<li>Platform</li>\n<li>DataSynapse</li>\n<li>Google MapReduce</li>\n<li>Hadoop</li>\n<li>GigaSpaces</li>\n<li>GridGain</li>\n</ul>\n<h4 id=\"load-balacing\" style=\"position:relative;\"><a href=\"#load-balacing\" aria-label=\"load balacing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Load balacing</h4>\n<ul>\n<li>Random allocation</li>\n<li>Round robin allocation</li>\n<li>Weighted allocation</li>\n<li>\n<p>Dynamic load balancing</p>\n<ul>\n<li>least connections</li>\n<li>least server CPU</li>\n</ul>\n</li>\n<li>DNS Round Robin</li>\n<li>Reverse Proxy (Apache mod_proxy, HAProxy, Squid, Nginx)</li>\n<li>Hardware Load Balacing (BIG-IP, Cisco)</li>\n</ul>\n<h1 id=\"паттерны-стабильности\" style=\"position:relative;\"><a href=\"#%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D1%8B-%D1%81%D1%82%D0%B0%D0%B1%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8\" aria-label=\"паттерны стабильности permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Паттерны стабильности</h1>\n<ul>\n<li>таймауты</li>\n<li>разрыв сети</li>\n<li>Let-it-crash</li>\n<li>Fail fast</li>\n<li>Bulkheads</li>\n<li>Steady state</li>\n<li>Throttling</li>\n</ul>","frontmatter":{"path":"/blog/architecture","title":"Architecture"}}},"pageContext":{}},"staticQueryHashes":["3649515864"]}